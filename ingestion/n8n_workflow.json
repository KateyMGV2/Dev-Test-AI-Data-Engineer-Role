{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -416,
        -160
      ],
      "id": "ff7680bd-6591-4c4f-9f05-0dcdb7a7c434",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "url": "https://drive.google.com/uc?export=download&id=1RXj_3txgmyX2Wyt9ZwM7l4axfi5A6EC-",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -192,
        -160
      ],
      "id": "a8873d25-3e32-44dc-ae50-514a3933beab",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  item.json.load_date = new Date().toISOString();\n  item.json.source_file_name = \"dataset.csv\";\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        -160
      ],
      "id": "77a259c7-794a-444c-ab8d-7b2c715fde3e",
      "name": "Code"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        80,
        -160
      ],
      "id": "bee85951-f267-44ff-b6c0-940990f03920",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "operation": "insert",
        "projectId": {
          "__rl": true,
          "value": "ageless-wall-470818-h0",
          "mode": "id"
        },
        "datasetId": {
          "__rl": true,
          "value": "my_dataset",
          "mode": "id"
        },
        "tableId": {
          "__rl": true,
          "value": "ads_spend",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleBigQuery",
      "typeVersion": 2.1,
      "position": [
        528,
        -160
      ],
      "id": "38731e2a-195a-4971-9f1a-4ca3ea1e9d45",
      "name": "Insert rows in a table",
      "alwaysOutputData": true,
      "executeOnce": false,
      "retryOnFail": false,
      "credentials": {
        "googleBigQueryOAuth2Api": {
          "id": "diePmJ7URO6Okb1o",
          "name": "Google BigQuery account 2"
        }
      }
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "ageless-wall-470818-h0",
          "mode": "list",
          "cachedResultName": "n8ntest",
          "cachedResultUrl": "https://console.cloud.google.com/bigquery?project=ageless-wall-470818-h0"
        },
        "sqlQuery": "SELECT *\nFROM `ageless-wall-470818-h0.mi_dataset.ads_spend`\nWHERE source_file_name = \"dataset.csv\"\nORDER BY load_date DESC\nLIMIT 10;\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.googleBigQuery",
      "typeVersion": 2.1,
      "position": [
        736,
        -160
      ],
      "id": "22eae66d-eb68-46f9-b746-c76710cb83a2",
      "name": "Execute a SQL query",
      "credentials": {
        "googleBigQueryOAuth2Api": {
          "id": "diePmJ7URO6Okb1o",
          "name": "Google BigQuery account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "Add Metadata\n",
        "height": 80,
        "width": 150,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        304,
        -32
      ],
      "typeVersion": 1,
      "id": "655fba19-12c8-4330-9b10-401043d75e0a",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "ageless-wall-470818-h0",
          "mode": "list",
          "cachedResultName": "n8ntest",
          "cachedResultUrl": "https://console.cloud.google.com/bigquery?project=ageless-wall-470818-h0"
        },
        "sqlQuery": "SELECT load_date, COUNT(*) AS total_rows\nFROM `ageless-wall-470818-h0.mi_dataset.ads_spend`\nGROUP BY load_date\nORDER BY load_date DESC;\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.googleBigQuery",
      "typeVersion": 2.1,
      "position": [
        736,
        64
      ],
      "id": "df8c0a27-ddf9-498d-bb53-f6c6e3fbf9aa",
      "name": "Execute a SQL query1",
      "credentials": {
        "googleBigQueryOAuth2Api": {
          "id": "diePmJ7URO6Okb1o",
          "name": "Google BigQuery account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "I chose SQL queries because they are quick, flexible, and transparent, making them ideal for a small dataset and a technical test scenario, while still producing robust metrics for analysis and visualization.",
        "height": 96,
        "width": 496,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -208,
        176
      ],
      "typeVersion": 1,
      "id": "2753a5ef-ea9f-4ab7-b115-2d056c66e901",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Part 1 – Ingestion (Foundation)",
        "height": 80,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -176,
        -256
      ],
      "typeVersion": 1,
      "id": "10a10dc8-0428-4794-a6ff-1ac4e8491680",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Part 2 – KPI Modeling (SQL)",
        "height": 80,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -176,
        80
      ],
      "typeVersion": 1,
      "id": "629c4014-4d6c-489c-8858-d1aa53bea3e6",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "Check persistence / summary",
        "height": 80,
        "width": 288,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        704,
        224
      ],
      "typeVersion": 1,
      "id": "c45081c1-ea5e-4d18-8aed-f5eefd537411",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Part 3 – Analyst Access",
        "height": 80,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -160,
        320
      ],
      "typeVersion": 1,
      "id": "65d952e2-1de1-4f60-b05a-e645e4891004",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "I chose a parameterized SQL script because it is simple, flexible, and immediately usable for analysts to access KPIs over any date range, without requiring additional infrastructure.",
        "height": 96,
        "width": 512,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -208,
        416
      ],
      "typeVersion": 1,
      "id": "121725c8-6468-4306-b4b4-fd2ac3f54ca1",
      "name": "Sticky Note6"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Insert rows in a table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert rows in a table": {
      "main": [
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          },
          {
            "node": "Execute a SQL query1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f49083a5-da81-4279-a93e-169bf5b42a87",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "296f59e7953d2335e4ec81bbb20023a143b5e496161d4791400a17a2b4fe7700"
  },
  "id": "yCvQOTRURQQCpVe6",
  "tags": []
}